name: cifar10_initial

conda_env: conda.yml

entry_points:
  building:
    parameters:
      dockerfile_path: { type: string, default: ./Dockerfile }
      model_filename: { type: string, default: cifar10_0.onnx }
      model_directory:
        { type: string, default: ./mlruns/0/abc/artifacts/downstream_directory }
      entrypoint_path:
        { type: string, default: ./onnx_runtime_server_entrypoint.sh }
      docker_image:
        {
          type: string,
          default: cwryu6252/ml-system-design-pattern:training_pattern_cifar10_0.0.1,
        }
    command: |
      cp ../{model_directory}/{model_filename} ./ && ^
      docker build ^
        -t {docker_image} ^
        -f {dockerfile_path} ^
        --build-arg model_filename={model_filename} ^
        --build-arg model_directory={model_directory} ^
        --build-arg entrypoint_path={entrypoint_path} ^
        .
